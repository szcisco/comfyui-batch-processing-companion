# Changelog

## v1.0 (2025-12-29)

### 🎉 首次发布
- 发布ComfyUI批量处理伴侣(ComfyUI_Batch_Processing_Companion)v1.0版本
- 基于Python+Tkinter开发的跨平台批量图像生成工具
- 专为ComfyUI用户设计，简化API调用流程

### ✨ 核心功能

#### 批量图像处理
- 支持一次性导入多张图片，配合提示词批量生成新图像
- 适用于电商产品图优化、短视频素材批量制作、漫画分镜批量渲染等场景

#### 灵活的工作流管理
- 采用JSON + INI配置文件组合方式管理ComfyUI工作流
- 支持从ComfyUI导出API格式的JSON工作流
- 配合INI配置文件定义参数映射关系，实现不同大模型、不同生图模式的快速切换

#### 智能参数绑定
- 可视化变量配置面板，可将工作流中的关键参数绑定到界面控件
- 自动识别工作流类型（图生图/文生图），并显示对应的操作界面
- 支持批量参数修改和管理

#### 多语言翻译集成
- 内置腾讯翻译API和Ollama本地大模型翻译两种方式
- 支持将中文提示词一键翻译为英文
- 支持批量翻译所有行的提示词

#### 中英文双语界面
- 完整支持中文简体和英文两种界面语言
- 可在设置中随时切换，不影响程序运行
- 支持中英文两种格式的工作流配置文件

### 🎨 UI界面优化

#### 菜单结构调整
- 将"系统"菜单更名为"文件"
- 在"系统设置"右侧增加"联系作者"菜单项
- 点击"联系作者"弹出包含技术交流、开源项目地址和商务合作信息的弹窗

#### 系统设置增强
- 在"程序主题"下方增加语言选择下拉菜单
- 支持中文简体和English两种语言切换
- 切换过程免重启，不影响程序运行

#### JSON转INI调试工具
- 修复检测和清除按钮显示问题
- 修复复制到变量功能，确保选定文本正确代入对应控件
- 修复变量绑定默认值显示问题
- 增加"帮助(help)"绿色按钮，弹出多标签帮助窗口
- 优化帮助文档表格格式化，提升可读性

#### 窗口布局优化
- 实现窗口居中显示在主应用程序中央
- 添加横向滚动条，方便查看长内容
- 优化鼠标滚轮事件处理，确保上下左右滑轮与对应滚动控件正确对应

#### 按钮功能增强
- 实现按钮颜色自动检测，基于变量状态动态变化
- 修复按钮颜色在复制操作后不更新的问题
- 增加"ini编辑"淡黄色按钮，用于打开JSON转INI调试工具

### ⚙️ 配置文件优化

#### 配置section名称修改
- 将`ComfyUI_API`/`api_dir`修改为`ComfyUI_tool_API`/`api_tool_dir`
- 移除硬编码模式，避免重写或覆盖配置文件

#### 生图规则重构
- **规则a**：无提示词的图生图模式
  - 功能模块结构：[图片载入],[图片尺寸高度],[图片尺寸宽度],[K采样步值],[图片输出]
  - 应用场景：已有图片的图生图模式

- **规则b**：有正面负面提示词的文生图模式
  - 功能模块结构：[正向提示词],[负面提示词],[K采样步值],[图片尺寸高度],[图片尺寸宽度],[图片输出]
  - 应用场景：需要输入正向和负面提示词的文生图模式

- **规则c**：有正面提示词的文生图模式
  - 功能模块结构：[正向提示词],[K采样步值],[图片尺寸高度],[图片尺寸宽度],[图片输出]
  - 应用场景：只需要输入正向提示词的文生图模式

#### UI显示模式优化
- **模式A**：无提示词的图生图模式
  - 显示图片相关控件和通用控件

- **模式B**：有正面负面提示词的文生图模式
  - 显示正向提示词、负面提示词相关控件和通用控件

- **模式C**：有正面提示词的文生图模式
  - 显示正向提示词相关控件和通用控件

### 🔧 技术优化

#### 框体管理系统
- 实现ModeDetector模式检测器，根据INI文件sections自动检测UI模式
- 实现FrameworkManager框体管理器，负责框体的完全删除和重建
- 实现LayoutManager布局管理器，实现自动左对齐布局
- 实现FrameworkFactory框体工厂，负责创建和重建各种UI框体

#### 变量绑定优化
- 支持中英文两种语言的变量绑定显示
- 实现变量绑定的自动转换功能
- 优化导入功能，根据当前语言状态自动转换索引名

#### 生图逻辑优化
- 优化生图规则检查逻辑，确保参数完整性
- 增强错误处理机制，提供清晰的错误提示
- 优化API通信流程，提升生图效率

### 📁 文件结构调整

#### 新增文件
- `src/help/help.py`：帮助文档模块
- `src/help/contact_author.py`：联系作者信息
- `src/help/language_map.py`：语言映射字典

#### 配置文件规范
- 优化setting.ini文件结构，分离不同功能模块的配置
- 实现配置文件的多语言支持
- 提供清晰的配置示例和说明

### 🚀 适用场景

- AI绘图工作室的批量出图需求
- 短视频/自媒体创作者的素材批量生成
- 电商产品图的AI风格化处理
- 游戏/动漫美术的概念图批量迭代
- 任何需要调用ComfyUI进行批量图像处理的场景

### 📝 技术特点

- 基于Python + Tkinter开发，跨平台支持
- 通过HTTP API与ComfyUI服务端通信，支持本地和远程部署
- 模块化的工作流配置系统，易于扩展新的生图模式
- 支持多主题界面切换，提供20+种视觉风格
- 完善的错误处理和日志记录机制

---

**发布时间**：2025年12月29日  
**项目地址**：https://github.com/szcisco  
**技术交流**：QQ群、微信等联系方式详见"联系作者"菜单